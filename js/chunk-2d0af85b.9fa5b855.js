(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0af85b"],{"0f4c":function(s,a,r){"use strict";r.r(a);var t=r("2877"),e=Object(t.a)({},(function(){var s=this;s.$createElement;return s._self._c,s._m(0)}),[function(){var s=this,a=s.$createElement,r=s._self._c||a;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("14 创建对象的多种方式以及优缺点")]),r("blockquote",[r("p",[s._v("JavaScript 深入系列第十四篇，讲解创建对象的各种方式，以及优缺点。")])]),r("h2",[s._v("写在前面")]),r("p",[s._v("这篇文章讲解创建对象的各种方式，以及优缺点。")]),r("p",[s._v("但是注意：")]),r("p",[s._v("这篇文章更像是笔记，因为《JavaScript 高级程序设计》写得真是太好了！")]),r("h2",[s._v("1. 工厂模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createPerson")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" o = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  o."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  o."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" o\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createPerson")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n")])]),r("p",[s._v("缺点：对象无法识别，因为所有的实例都指向一个原型")]),r("h2",[s._v("2. 构造函数模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n")])]),r("p",[s._v("优点：实例可以识别为一个特定的类型")]),r("p",[s._v("缺点：每次创建实例时，每个方法都要被创建一次")]),r("h2",[s._v("2.1 构造函数模式优化")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = getName\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n")])]),r("p",[s._v("优点：解决了每个方法都要被重新创建的问题")]),r("p",[s._v("缺点：这叫啥封装……")]),r("h2",[s._v("3. 原型模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'keivn'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\n")])]),r("p",[s._v("优点：方法不会重新创建")]),r("p",[s._v("缺点：1. 所有的属性和方法都共享 2. 不能初始化参数")]),r("h2",[s._v("3.1 原型模式优化")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(" = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("getName")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\n")])]),r("p",[s._v("优点：封装性好了一点")]),r("p",[s._v("缺点：重写了原型，丢失了 constructor 属性")]),r("h2",[s._v("3.2 原型模式优化")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(" = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("constructor")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("getName")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\n")])]),r("p",[s._v("优点：实例可以通过 constructor 属性找到所属构造函数")]),r("p",[s._v("缺点：原型模式该有的缺点还是有")]),r("h2",[s._v("4. 组合模式")]),r("p",[s._v("构造函数模式与原型模式双剑合璧。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(" = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("constructor")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("getName")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\n")])]),r("p",[s._v("优点：该共享的共享，该私有的私有，使用最广泛的方式")]),r("p",[s._v("缺点：有的人就是希望全部都写在一起，即更好的封装性")]),r("h2",[s._v("4.1 动态原型模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" != "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n    }\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\n")])]),r("p",[s._v("注意：使用动态原型模式时，不能用对象字面量重写原型")]),r("p",[s._v("解释下为什么：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" != "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(" = {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("constructor")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(",\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("getName")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n        "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n      }\n    }\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person2 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'daisy'")]),s._v(")\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报错 并没有该方法")]),s._v("\nperson1."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 注释掉上面的代码，这句是可以执行的。")]),s._v("\nperson2."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()\n")])]),r("p",[s._v("为了解释这个问题，假设开始执行"),r("code",{pre:!0},[s._v("var person1 = new Person('kevin')")]),s._v("。")]),r("p",[s._v("如果对 new 和 apply 的底层执行过程不是很熟悉，可以阅读底部相关链接中的文章。")]),r("p",[s._v("我们回顾下 new 的实现步骤：")]),r("ol",[r("li",[s._v("首先新建一个对象")]),r("li",[s._v("然后将对象的原型指向 Person.prototype")]),r("li",[s._v("然后 Person.apply(obj)")]),r("li",[s._v("返回这个对象")])]),r("p",[s._v("注意这个时候，回顾下 apply 的实现步骤，会执行 obj.Person 方法，这个时候就会执行 if 语句里的内容，注意构造函数的 prototype 属性指向了实例的原型，使用字面量方式直接覆盖 Person.prototype，并不会更改实例的原型的值，person1 依然是指向了以前的原型，而不是 Person.prototype。而之前的原型是没有 getName 方法的，所以就报错了！")]),r("p",[s._v("如果你就是想用字面量方式写代码，可以尝试下这种：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" != "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(" = {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("constructor")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(",\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("getName")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n        "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n      }\n    }\n\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("(name)\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person2 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'daisy'")]),s._v(")\n\nperson1."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// kevin")]),s._v("\nperson2."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// daisy")]),s._v("\n")])]),r("h3",[s._v("5.1 寄生构造函数模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" o = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  o."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  o."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n  }\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" o\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person1 "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// false")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person1 "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),r("p",[s._v("寄生构造函数模式，我个人认为应该这样读：")]),r("p",[s._v("寄生-构造函数-模式，也就是说寄生在构造函数的一种方法。")]),r("p",[s._v("也就是说打着构造函数的幌子挂羊头卖狗肉，你看创建的实例使用 "),r("code",{pre:!0},[s._v("instanceof")]),s._v(" 都"),r("strong",[s._v("无法指向")]),s._v("构造函数！")]),r("p",[s._v("这样方法可以在特殊情况下使用。比如我们想创建一个具有额外方法的特殊数组，但是又不想直接修改 Array 构造函数，我们可以这样写：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("SpecialArray")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" values = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("()\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n    values."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("[i])\n  }\n\n  values."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("toPipedString")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("join")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'|'")]),s._v(")\n  }\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" values\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" colors = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SpecialArray")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'red'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'blue'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'green'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" colors2 = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SpecialArray")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'red2'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'blue2'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'green2'")]),s._v(")\n\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(colors) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// ["red", "blue", "green", toPipedString: ƒ]')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(colors."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toPipedString")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// red|blue|green")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(colors2) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// ["red2", "blue2", "green2", toPipedString: ƒ]')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(colors2."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toPipedString")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// red2|blue2|green2")]),s._v("\n")])]),r("p",[s._v("你会发现，其实所谓的寄生构造函数模式就是比工厂模式在创建对象的时候，多使用了一个 new，实际上两者的结果是一样的。")]),r("p",[s._v("但是作者可能是希望能像使用普通 Array 一样使用 SpecialArray，虽然把 SpecialArray 当成函数也一样能用，但是这并不是作者的本意，也变得不优雅。")]),r("p",[s._v("在可以使用其他模式的情况下，不要使用这种模式。")]),r("p",[s._v("但是值得一提的是，上面例子中的循环：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n  values."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("[i])\n}\n")])]),r("p",[s._v("可以替换成：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("values."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("push")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(values, "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n")])]),r("h2",[s._v("5.2 稳妥构造函数模式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" o = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  o."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("sayName")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(name)\n  }\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" o\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person1 = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("person")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(")\n\nperson1."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayName")]),s._v("() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// kevin")]),s._v("\n\nperson1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'daisy'")]),s._v("\n\nperson1."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayName")]),s._v("() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// kevin")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// daisy")]),s._v("\n")])]),r("p",[s._v("所谓稳妥对象，指的是没有公共属性，而且其方法也不引用 this 的对象。")]),r("p",[s._v("与寄生构造函数模式有两点不同：")]),r("ol",[r("li",[s._v("新创建的实例方法不引用 this")]),r("li",[s._v("不使用 new 操作符调用构造函数")])]),r("p",[s._v("稳妥对象最适合在一些安全的环境中。")]),r("p",[s._v("稳妥构造函数模式也跟工厂模式一样，无法识别对象所属类型。")]),r("h2",[s._v("下一篇文章")]),r("p",[r("a",{attrs:{href:"#/qingfeng/deep/deep-15"}},[s._v("15 继承的多种方式和优缺点")])]),r("h2",[s._v("相关链接")]),r("p",[r("a",{attrs:{href:"#/qingfeng/deep/deep-01"}},[s._v("《01 从原型到原型链》")])]),r("p",[r("a",{attrs:{href:"#/qingfeng/deep/deep-10"}},[s._v("《10 call 和 apply 的模拟实现》")])]),r("p",[r("a",{attrs:{href:"#/qingfeng/deep/deep-12"}},[s._v("《12 new 的模拟实现》")])])])])])}],!1,null,null,null);a.default=e.exports}}]);