(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0ddb76"],{8327:function(s,a,t){"use strict";t.r(a);var r=t("2877"),l=Object(r.a)({},(function(){var s=this;s.$createElement;return s._self._c,s._m(0)}),[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("html",[t("head"),t("body",[t("h1",[s._v("10 call 和 apply 的模拟实现")]),t("blockquote",[t("p",[s._v("JavaScript 深入系列第十篇，通过 call 和 apply 的模拟实现，带你揭开 call 和 apply 改变 this 的真相")])]),t("h2",[s._v("call")]),t("p",[s._v("一句话介绍 call：")]),t("blockquote",[t("p",[s._v("call() 方法在使用一个指定的 this 值和若干个指定的参数值的前提下调用某个函数或方法。")])]),t("p",[s._v("举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" foo = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(foo) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("注意两点：")]),t("ol",[t("li",[s._v("call 改变了 this 的指向，指向到 foo")]),t("li",[s._v("bar 函数执行了")])]),t("h2",[s._v("模拟实现第一步")]),t("p",[s._v("那么我们该怎么模拟实现这两个效果呢？")]),t("p",[s._v("试想当调用 call 的时候，把 foo 对象改造成如下：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" foo = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("bar")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n  }\n}\n\nfoo."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("() "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("这个时候 this 就指向了 foo，是不是很简单呢？")]),t("p",[s._v("但是这样却给 foo 对象本身添加了一个属性，这可不行呐！")]),t("p",[s._v("不过也不用担心，我们用 delete 再删除它不就好了~")]),t("p",[s._v("所以我们模拟的步骤可以分为：")]),t("ol",[t("li",[s._v("将函数设为对象的属性")]),t("li",[s._v("执行该函数")]),t("li",[s._v("删除该函数")])]),t("p",[s._v("以上个例子为例，就是：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第一步")]),s._v("\nfoo."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = bar\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第二步")]),s._v("\nfoo."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v("()\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第三步")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" foo."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v("\n")])]),t("p",[s._v("fn 是对象的属性名，反正最后也要删除它，所以起成什么都无所谓。")]),t("p",[s._v("根据这个思路，我们可以尝试着去写第一版的 "),t("strong",[s._v("call2")]),s._v(" 函数：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第一版")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("call2")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("context")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 首先要获取调用call的函数，用this可以获取")]),s._v("\n  context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n  context."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v("()\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 测试一下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" foo = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call2")]),s._v("(foo) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("正好可以打印 1 哎！是不是很开心！(～￣ ▽ ￣)～")]),t("h2",[s._v("模拟实现第二步")]),t("p",[s._v("最一开始也讲了，call 函数还能给定参数执行函数。举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" foo = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(name)\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(age)\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(foo, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v(")\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// kevin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 18")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("注意：传入的参数并不确定，这可咋办？")]),t("p",[s._v("不急，我们可以从 Arguments 对象中取值，取出第二个到最后一个参数，然后放到一个数组里。")]),t("p",[s._v("比如这样：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 以上个例子为例，此时的arguments为：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// arguments = {")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//      0: foo,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//      1: 'kevin',")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//      2: 18,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//      length: 3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// }")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 因为arguments是类数组对象，所以可以用for循环")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = []\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", len = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n  args."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'arguments['")]),s._v(" + i + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("']'")]),s._v(")\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 执行后 args为 ["arguments[1]", "arguments[2]", "arguments[3]"]')]),s._v("\n")])]),t("p",[s._v("不定长的参数问题解决了，我们接着要把这个参数数组放到要执行的函数的参数里面去。")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将数组里的元素作为多个参数放进函数的形参里")]),s._v("\ncontext."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v("(args."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("join")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("','")]),s._v("))\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (O_o)??")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这个方法肯定是不行的啦！！！")]),s._v("\n")])]),t("p",[s._v("也许有人想到用 ES6 的方法，不过 call 是 ES3 的方法，我们为了模拟实现一个 ES3 的方法，要用到 ES6 的方法，好像……，嗯，也可以啦。但是我们这次用 eval 方法拼成一个函数，类似于这样：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'context.fn('")]),s._v(" + args + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("')'")]),s._v(")\n")])]),t("p",[s._v("这里 args 会自动调用 Array.toString() 这个方法。")]),t("p",[s._v("所以我们的第二版克服了两个大问题，代码如下：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第二版")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("call2")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("context")]),s._v(") {\n  context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = []\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", len = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n    args."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'arguments['")]),s._v(" + i + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("']'")]),s._v(")\n  }\n  "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'context.fn('")]),s._v(" + args + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("')'")]),s._v(")\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 测试一下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" foo = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(name)\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(age)\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call2")]),s._v("(foo, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v(")\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// kevin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 18")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("(๑•̀ㅂ•́)و✧")]),t("h2",[s._v("模拟实现第三步")]),t("p",[s._v("模拟代码已经完成 80%，还有两个小点要注意：")]),t("h3",[s._v("1.this 参数可以传 null，当为 null 的时候，视为指向 window")]),t("p",[s._v("举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" value = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),t("p",[s._v("虽然这个例子本身不使用 call，结果依然一样。")]),t("p",[t("strong",[s._v("2.函数是可以有返回值的！")])]),t("p",[s._v("举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": name,\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("age")]),s._v(": age\n  }\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(bar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(obj, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v("))\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Object {")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    value: 1,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    name: 'kevin',")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    age: 18")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// }")]),s._v("\n")])]),t("p",[s._v("不过都很好解决，让我们直接看第三版也就是最后一版的代码：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第三版")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("call2")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("context")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" context = context || "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("\n  context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = []\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", len = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n    args."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'arguments['")]),s._v(" + i + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("']'")]),s._v(")\n  }\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'context.fn('")]),s._v(" + args + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("')'")]),s._v(")\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 测试一下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" value = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(")\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": name,\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("age")]),s._v(": age\n  }\n}\n\nbar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(bar."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call2")]),s._v("(obj, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v("))\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Object {")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    value: 1,")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    name: 'kevin',")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//    age: 18")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// }")]),s._v("\n")])]),t("p",[s._v("到此，我们完成了 call 的模拟实现，给自己一个赞 ｂ（￣ ▽ ￣）ｄ")]),t("h2",[s._v("apply 的模拟实现")]),t("p",[s._v("apply 的实现跟 call 类似，在这里直接给代码，代码来自于知乎 @郑航的实现：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("apply")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("context, arr")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" context = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("(context) || "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("\n  context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!arr) {\n    result = context."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v("()\n  } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = []\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = arr."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n      args."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'arr['")]),s._v(" + i + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("']'")]),s._v(")\n    }\n    result = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'context.fn('")]),s._v(" + args + "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("')'")]),s._v(")\n  }\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" context."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result\n}\n")])]),t("h2",[s._v("下一篇文章")]),t("p",[t("a",{attrs:{href:"#/qingfeng/deep/deep-11"}},[s._v("11 bind 的模拟实现")])]),t("h2",[s._v("重要参考")]),t("p",[t("a",{attrs:{href:"https://www.zhihu.com/question/35787390"}},[s._v("知乎问题 不能使用 call、apply、bind，如何用 js 实现 call 或者 apply 的功能？")])])])])])}],!1,null,null,null);a.default=l.exports}}]);