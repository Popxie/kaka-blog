(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0b9049"],{"30c9":function(e,n,a){"use strict";a.r(n);var p=a("2877"),r=Object(p.a)({},(function(){var e=this;e.$createElement;return e._self._c,e._m(0)}),[function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("section",[a("html",[a("head"),a("body",[a("h1",[e._v("npm & yarn")]),a("h2",[e._v("npm 包管理历史发展")]),a("ul",[a("li",[a("p",[e._v("npm 出现之前：前端依赖项是保存到存储库中并手动下载的")])]),a("li",[a("p",[e._v("2010：npm 发布并支持 nodejs")])]),a("li",[a("p",[e._v("2012：npm 的使用量急剧增加——主要是由于 Browserifys 浏览器的支持")])]),a("li",[a("p",[e._v("2012：npm 有了一个竞争对手 bower，它完全支持浏览器")])]),a("li",[a("p",[e._v("2012-2016：前端项目的依赖项数量成倍增加")])]),a("li",[a("p",[e._v("2012-2016：构建和安装前端应用变得越来越慢")])]),a("li",[a("p",[e._v("2012-2016：大量（重复的）依赖项存储在神奇的 node_modules 内的嵌套文件夹中 ☢️")])]),a("li",[a("p",[e._v("2012-2016：rm -rf node_modules 成为前端开发人员最常用的命令。")])]),a("li",[a("p",[e._v("2015：bower 输给了 npm")])]),a("li",[a("p",[e._v("2015：node_modules 被修改为扁平化的文件结构！")])]),a("li",[a("p",[e._v("2016： left-pad 成为当时的新闻头条")])]),a("li",[a("p",[e._v("2016： yarn 发布")]),a("ul",[a("li",[e._v("支持 npm 和 bower 仓库")]),a("li",[e._v("yarn.lock 能够锁定安装的版本并提供确定性的依赖关系。不再 rm -rf node_modules！")]),a("li",[e._v("yarn install 花费的时间是 npm install 的一半（不使用缓存的前提下）")]),a("li",[e._v("缓存和脱机模式使构建过程几乎不花费时间")])])]),a("li",[a("p",[e._v("2016：npm 发布 shrinkwrap")]),a("ul",[a("li",[e._v("尝试处理依赖项锁定")]),a("li",[e._v("不幸的是，一些错误和超出其管理能力的承诺导致该工具的声誉下降")])])]),a("li",[a("p",[e._v("2017：npm 5 发布")]),a("ul",[a("li",[e._v("package-lock.json 是他们的新工具，shrinkwrap 被放在一边")]),a("li",[e._v("package-lock.json 开始与 yarns 锁定文件竞争")])])]),a("li",[a("p",[e._v("2018：npm ci 发布")]),a("ul",[a("li",[e._v("直接用 package-lock.json 构建代码")]),a("li",[e._v("没有代价高昂的依赖项安全性分析和版本分析")]),a("li",[e._v("大大减少了在构建服务器上的构建时间！")])])]),a("li",[a("p",[e._v("2018：npm 6 发布 ‍♀️")]),a("ul",[a("li",[e._v("npm 检查要安装的依赖项中的安全漏洞")]),a("li",[e._v("yarn 和 npm 的构建时间不再有显差异")])])]),a("li",[a("p",[e._v("2019：tink 开始进入 beta 模式")]),a("ul",[a("li",[e._v("避免使用 node_modules，而是为项目中的每个依赖项创建一个带有哈希值的文件")]),a("li",[e._v("尚未做好投入生产环境的准备")])])]),a("li",[a("p",[e._v("...")])])]),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/99186425"}},[e._v("阅读原文·知乎")])]),a("hr"),a("h2",[e._v("常用命令")]),a("h3",[e._v("1.初始化一个新的项目")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn init --"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("yes")]),e._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 简写 -y")]),e._v("\n\nnpm init --"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("yes")]),e._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 简写 -y")]),e._v("\n")])]),a("h3",[e._v("2.添加项目依赖/开发依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn add <package> [--dev/-D] // 不带-D默认生产环境\nyarn add [package]@[version] "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("#带版本")]),e._v("\n\nnpm install XXX --save 可以简写成npm i XXX -S --------\x3e 安装项目依赖\nnpm install XXX --save-dev可以简写成npm i XXX -D ------\x3e 安装开发依赖\n")])]),a("h3",[e._v("3.查看源和换源")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm config get registry  // 查看npm当前镜像源\nnpm config "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("set")]),e._v(" registry https://registry.npm.taobao.org/  // 设置npm镜像源为淘宝镜像\n\nyarn config get registry  // 查看yarn当前镜像源\nyarn config "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("set")]),e._v(" registry https://registry.npm.taobao.org/  // 设置yarn镜像源为淘宝镜像\n\n镜像源地址部分如下：\nnpm --- https://registry.npmjs.org/\ncnpm --- https://r.cnpmjs.org/\ntaobao --- https://registry.npm.taobao.org/\n")])]),a("h3",[e._v("4.全局安装一个依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn global add [package]\n\nnpm install [package] -g\n")])]),a("h3",[e._v("5.移除一个依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn remove <packageName>\n\nnpm uninstall <packageName> -S\n")])]),a("h3",[e._v("6.全局删除一个依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn global remove <packageName>\n\nnpm uninstall -g <packageName>\n")])]),a("h3",[e._v("7.安装所有依赖包")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn\nnpm install || npm i\n")])]),a("h3",[e._v("8.升级依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn upgrade "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 升级所有依赖项，不记录在 package.json 中")]),e._v("\nnpm update "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# npm 可以通过 ‘--save|--save-dev’ 指定升级哪类依赖")]),e._v("\n\nyarn upgrade webpack "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 升级指定包")]),e._v("\nnpm update webpack --save-dev "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# npm")]),e._v("\n\nyarn upgrade --latest "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 忽略版本规则，升级到最新版本，并且更新 package.json")]),e._v("\n")])]),a("h3",[e._v("9.列出全局安装的所有依赖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn global list --depth=0    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 限制依赖的深度")]),e._v("\n\nnpm list -g --depth=0\n")])]),a("h3",[e._v("10.缓存清理")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn cache clean\n\nnpm cache clean --force\n")])]),a("h3",[e._v("11.查看依赖所有历史版本")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("yarn info <package...>\n\nnpm v <package...> versions  //缩写\n")])]),a("h2",[e._v("优缺点")]),a("h3",[e._v("基于 "),a("code",{pre:!0},[e._v("npm")]),e._v(", "),a("code",{pre:!0},[e._v("yarn")]),e._v(" 做了哪些优化")]),a("ul",[a("li",[a("p",[a("code",{pre:!0},[e._v("并行安装")]),e._v("： 无论 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 还是 "),a("code",{pre:!0},[e._v("yarn")]),e._v(" 在执行包的安装时，都会执行一系列任务。 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 是按照队列执行每个 "),a("code",{pre:!0},[e._v("package")]),e._v(" ，也就是说必须要等到当前 "),a("code",{pre:!0},[e._v("package")]),e._v(" 安装完成之后，才能继续后面的安装。而 yarn 是同步执行所有任务，提高了性能。")])]),a("li",[a("p",[a("code",{pre:!0},[e._v("离线模式")]),e._v(": 如果之前已经安装过一个软件包，用 "),a("code",{pre:!0},[e._v("yarn")]),e._v(" 再次安装时之间从缓存中获取，就不用像 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 那样再从网络下载了。")])]),a("li",[a("p",[a("code",{pre:!0},[e._v("安装版本统一")]),e._v(": 为了防止拉取到不同的版本，"),a("code",{pre:!0},[e._v("yarn")]),e._v(" 有一个锁定文件 ("),a("code",{pre:!0},[e._v("lock file")]),e._v(") 记录了被确切安装上的模块的版本号。每次只要新增了一个模块，"),a("code",{pre:!0},[e._v("yarn")]),e._v(" 就会创建（或更新）"),a("code",{pre:!0},[e._v("yarn.lock")]),e._v(" 这个文件。这么做就保证了，每一次拉取同一个项目依赖时，使用的都是一样的模块版本。")])]),a("li",[a("p",[a("code",{pre:!0},[e._v("更好的语义化")]),e._v(": "),a("code",{pre:!0},[e._v("yarn")]),e._v(" 改变了一些 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 命令的名称，比如 "),a("code",{pre:!0},[e._v("yarn add/remove")]),e._v("，比 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 原本的 "),a("code",{pre:!0},[e._v("install/uninstall")]),e._v("要更清晰。")])])]),a("p",[a("strong",[e._v("注意 cnpm 不支持 package-lock")])]),a("p",[e._v("，")]),a("blockquote",[a("p",[e._v("使用 "),a("code",{pre:!0},[e._v("cnpm install")]),e._v(" 时候，并不会生成 "),a("code",{pre:!0},[e._v("package-lock.json")]),e._v(" 文件。"),a("code",{pre:!0},[e._v("cnpm install")]),e._v(" 的时候，就算你项目中有 "),a("code",{pre:!0},[e._v("package-lock.json")]),e._v(" 文件，cnpm 也不会识别，仍会根据 package.json 来安装。所以这就是为什么之前你用 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 安装产生了 "),a("code",{pre:!0},[e._v("package-lock.json")]),e._v("，后面的人用 cnpm 来安装，可能会跟你安装的依赖包不一致。")])]),a("p",[e._v("因此，尽量不要直接使用 "),a("code",{pre:!0},[e._v("cnpm install")]),e._v(" 安装项目依赖包。但是为了解决直接使用 "),a("code",{pre:!0},[e._v("npm install")]),e._v(" 速度慢的问题，可以设置 "),a("code",{pre:!0},[e._v("npm")]),e._v(" 代理解决。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 设置淘宝镜像代理")]),e._v("\nnpm config "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("set")]),e._v(" registry https://registry.npm.taobao.org\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# 查看已设置代理")]),e._v("\nnpm config get registry\n")])]),a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/HXiI1QIbknzwaPlquVVs4Q"}},[e._v("阅读原文")])])])])])}],!1,null,null,null);n.default=r.exports}}]);