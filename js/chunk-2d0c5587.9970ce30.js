(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0c5587"],{"3f64":function(s,a,t){"use strict";t.r(a);var r=t("2877"),e=Object(r.a)({},(function(){var s=this;s.$createElement;return s._self._c,s._m(0)}),[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("html",[t("head"),t("body",[t("h1",[s._v("12 new 的模拟实现")]),t("blockquote",[t("p",[s._v("JavaScript 深入系列第十二篇，通过 new 的模拟实现，带大家揭开使用 new 获得构造函数实例的真相")])]),t("h2",[s._v("new")]),t("p",[s._v("一句话介绍 new:")]),t("blockquote",[t("p",[s._v("new 运算符创建一个用户定义的对象类型的实例或具有构造函数的内置对象类型之一")])]),t("p",[s._v("也许有点难懂，我们在模拟 new 之前，先看看 new 实现了哪些功能。")]),t("p",[s._v("举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Otaku 御宅族，简称宅")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Games'")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 因为缺乏锻炼的缘故，身体强度让人担忧")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("60")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("sayYourName")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'I am '")]),s._v(" + "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'18'")]),s._v(")\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Kevin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Games")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 60")]),s._v("\n\nperson."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayYourName")]),s._v("() "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// I am Kevin")]),s._v("\n")])]),t("p",[s._v("从这个例子中，我们可以看到，实例 person 可以：")]),t("ol",[t("li",[s._v("访问到 Otaku 构造函数里的属性")]),t("li",[s._v("访问到 Otaku.prototype 中的属性")])]),t("p",[s._v("接下来，我们可以尝试着模拟一下了。")]),t("p",[s._v("因为 new 是关键字，所以无法像 bind 函数一样直接覆盖，所以我们写一个函数，命名为 objectFactory，来模拟 new 的效果。用的时候是这样的：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Otaku")]),s._v(" () {\n    ……\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用 new")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("(……);\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用 objectFactory")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("objectFactory")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v(", ……)\n")])]),t("h2",[s._v("初步实现")]),t("p",[s._v("分析：")]),t("p",[s._v("因为 new 的结果是一个新对象，所以在模拟实现的时候，我们也要建立一个新对象，假设这个对象叫 obj，因为 obj 会具有 Otaku 构造函数里的属性，想想经典继承的例子，我们可以使用 Otaku.apply(obj, arguments)来给 obj 添加新的属性。")]),t("p",[s._v("在 JavaScript 深入系列第一篇中，我们便讲了原型与原型链，我们知道实例的 __proto__ 属性会指向构造函数的 prototype，也正是因为建立起这样的关系，实例可以访问原型上的属性。")]),t("p",[s._v("现在，我们可以尝试着写第一版了：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第一版代码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("objectFactory")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v(" = []."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("shift")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 截取 arguments[0] 数据")]),s._v("\n\n  obj."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("__proto__")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(obj, "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Constructor.bind(obj)(arguments[0], arguments[1]) // 同上")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Constructor.call(obj, arguments[0], arguments[1]) // 同上 三种方式都ok")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Constructor(arguments) // 导致 Otaku 中的this指向window")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" obj\n}\n")])]),t("p",[s._v("在这一版中，我们：")]),t("ol",[t("li",[s._v("用 new Object() 的方式新建了一个对象 obj")]),t("li",[s._v("取出第一个参数，就是我们要传入的构造函数。此外因为 shift 会修改原数组，所以 arguments 会被去除第一个参数")]),t("li",[s._v("将 obj 的原型指向构造函数，这样 obj 就可以访问到构造函数原型中的属性")]),t("li",[s._v("使用 apply，改变构造函数 this 的指向到新建的对象，这样 obj 就可以访问到构造函数中的属性(不用apply的话构造函数Otaku中的this指向window)")]),t("li",[s._v("返回 obj")])]),t("p",[s._v("更多关于：")]),t("p",[s._v("原型与原型链，可以看"),t("a",{attrs:{href:"#/qingfeng/deep/deep-01"}},[s._v("《01 从原型到原型链》")])]),t("p",[s._v("apply，可以看"),t("a",{attrs:{href:"#/qingfeng/deep/deep-10"}},[s._v("《10 call 和 apply 的模拟实现》")])]),t("p",[s._v("经典继承，可以看"),t("a",{attrs:{href:"#/qingfeng/deep/deep-15"}},[s._v("15《继承》")])]),t("p",[s._v("复制以下的代码，到浏览器中，我们可以做一下测试：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Games'")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("60")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("sayYourName")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'I am '")]),s._v(" + "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("objectFactory")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v(" = []."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("shift")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 指向 Otaku")]),s._v("\n  obj."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("__proto__")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(obj, "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" obj\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("objectFactory")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'18'")]),s._v(")\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Kevin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Games")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 60")]),s._v("\n\nperson."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayYourName")]),s._v("() "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// I am Kevin")]),s._v("\n")])]),t("p",[s._v("[]~(￣ ▽ ￣)~**")]),t("h2",[s._v("返回值效果实现")]),t("p",[s._v("接下来我们再来看一种情况，假如构造函数有返回值，举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("60")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": name,\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("habit")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Games'")]),s._v("\n  }\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'18'")]),s._v(")\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Kevin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Games")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// undefined")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// undefined")]),s._v("\n")])]),t("p",[s._v("在这个例子中，构造函数返回了一个对象，在实例 person 中只能访问返回的对象中的属性。")]),t("p",[s._v("而且还要注意一点，在这里我们是返回了一个对象，假如我们只是返回一个基本类型的值呢？")]),t("p",[s._v("再举个例子：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, age")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("60")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'handsome boy'")]),s._v("\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" person = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Otaku")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Kevin'")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'18'")]),s._v(")\n\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// undefined")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("habit")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// undefined")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strength")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 60")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(person."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 18")]),s._v("\n")])]),t("p",[s._v("结果完全颠倒过来，这次尽管有返回值，但是相当于没有返回值进行处理。")]),t("p",[s._v("所以我们还需要判断返回的值是不是一个对象，如果是一个对象，我们就返回这个对象，如果没有，我们该返回什么就返回什么。")]),t("p",[s._v("再来看第二版的代码，也是最后一版的代码：")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第二版的代码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("objectFactory")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("()\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v(" = []."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("shift")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\n  obj."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("__proto__")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ret = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(obj, "),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" ret === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(" ? ret : obj\n}\n")])]),t("h2",[s._v("下一篇文章")]),t("p",[t("a",{attrs:{href:"#/qingfeng/deep/deep-13"}},[s._v("13 类数组对象与 arguments")])]),t("h2",[s._v("相关链接")]),t("p",[t("a",{attrs:{href:"#/qingfeng/deep/deep-01"}},[s._v("《01 从原型到原型链》")])]),t("p",[t("a",{attrs:{href:"#/qingfeng/deep/deep-10"}},[s._v("《10 call 和 apply 的模拟实现》")])]),t("p",[t("a",{attrs:{href:"#/qingfeng/deep/deep-15"}},[s._v("《15 继承》")])])])])])}],!1,null,null,null);a.default=e.exports}}]);