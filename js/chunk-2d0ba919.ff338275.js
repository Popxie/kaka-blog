(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0ba919"],{3886:function(s,a,t){"use strict";t.r(a);var r=t("2877"),l=Object(r.a)({},(function(){var s=this;s.$createElement;return s._self._c,s._m(0)}),[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("html",[t("head"),t("body",[t("h1",[s._v("Object & Array 的深拷贝")]),t("p",[s._v("首先看个例子:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(" }\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" b = a\nb."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 李四")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 李四")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" a = ["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" b = a\nb."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(")\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//1,2,3,4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//1,2,3,4")]),s._v("\n")])]),t("p",[s._v("因为在 JavaScript 中,对象跟数组属于引用数据类型,指针都会指向同一个,所以一改都改. 如何各改各的呢?(深拷贝)")]),t("h2",[s._v("方法一 (拓展运算符，只深拷贝第一层)")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(" }\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" b = { ...a }\nb."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "张三"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "李四"}')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = ["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("]\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" b = [...a]\nb["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("] = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [1, 2]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [1, 3]")]),s._v("\n")])]),t("h2",[s._v("方法二 (JSON.parse(JSON.stringify()))")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(" }\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" b = {}\nb = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("parse")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stringify")]),s._v("(a))\nb."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "张三"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "李四"}')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = ["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("]\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" b = []\nb = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("parse")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stringify")]),s._v("(a))\nb["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("] = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [1,2]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [3]")]),s._v("\n")])]),t("h3",[s._v("缺点")]),t("blockquote",[t("ul",[t("li",[t("strong",[s._v("正则会被处理为空对象")])]),t("li",[t("strong",[s._v("具备函数/symbol/undefined 属性值直接被干掉")])]),t("li",[t("strong",[s._v("BigInt 还处理不了，会报错 // Uncaught TypeError: Do not know how to serialize a BigInt")])]),t("li",[t("strong",[s._v("日期对象最后还是字符串")])])])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" obj = {\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("b")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/^$/")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("c")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("d")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("()\n}\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("parse")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stringify")]),s._v("(obj)))\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 结果如下")]),s._v("\n{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("b")]),s._v(":{},\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("d")]),s._v(":"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"2020-11-20T07:04:10.653Z"')]),s._v("\n}\n")])]),t("h2",[s._v("方法三 (函数方法)")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deepCopy")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("param")]),s._v(") {\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!param) "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" param\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (param "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("(param)\n  \n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (param "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("RegExp")]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("RegExp")]),s._v("(param)\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" param !== "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"object"')]),s._v(") "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" param\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// const blankArrOrObj = param instanceof Array ? [] : {}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 或者")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" blankArrOrObj = "),t("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isArray")]),s._v("(param) ? [] : {}\n\n  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// tips: for in 如果是数组那么就是 (index in arr) 如果是 对象 则就是 (key in obj)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" keyOrIndex "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" param) {\n    blankArrOrObj[keyOrIndex] = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" param[keyOrIndex] === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(" \n      ? "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deepCopy")]),s._v("(param[keyOrIndex]) \n      : param[key]\n  }\n  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" blankArrOrObj\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(" }\nb = "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deepCopy")]),s._v("(a)\nb."),t("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "张三"}')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {name: "李四"}')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" a = ["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("]\nb = "),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deepCopy")]),s._v("(a)\nb["),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("] = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a:'")]),s._v(", a) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [1,2]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),t("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b:'")]),s._v(", b) "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// [3]")]),s._v("\n")])]),t("p",[t("a",{attrs:{href:"https://juejin.im/post/6844903692756336653"}},[s._v("深拷贝的终极探索·掘金")]),t("br"),t("a",{attrs:{href:"https://juejin.cn/post/6844904197595332622"}},[s._v("浅拷贝与深拷贝·掘金")])])])])])}],!1,null,null,null);a.default=l.exports}}]);